# -*- coding: utf-8 -*-
"""Titanic survival prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1QN9yu00DtRKB2Qiiw_D8uFNj_730hSIH
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

df = pd.read_csv('/content/train.csv')

df

df.shape

df.describe()

df.info()

df.isnull().sum()

#Drop the column 'Cabin' as it is missng alot of values
df = df.drop(columns = 'Cabin', axis = 1)

df.head()

# Filling missing values in Age column with mean
df['Age'].fillna(df['Age'].mean(), inplace = True)

df.isnull().sum()

df['Embarked'] = df['Embarked'].fillna(df['Embarked'].mode()[0])

print(df['Embarked'].mode()[0])

df.isnull().sum()

df['Survived'].value_counts()

sns.set()
sns.countplot(x = 'Survived', data = df)

sns.set()
sns.countplot(x = 'Sex', data = df)

sns.countplot(x = 'Sex', hue = 'Survived', data = df)

# 3 diff classes of tickets
sns.countplot(x = 'Pclass', hue = 'Survived', data = df)

# Label Encoding
df.replace({'Sex': {'male':0, 'female': 1}}, inplace=True)

df.replace({'Embarked':{'S': 0, 'C': 1, 'Q': 2}}, inplace=True)

df

x = df.drop(columns = ['PassengerId', 'Name', 'Ticket', 'Survived'], axis = 1)
y = df['Survived']

x

y

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 2)

print(x.shape, x_test.shape, x_train.shape)

model = LogisticRegression()

model.fit(x_train, y_train)

training_acc = accuracy_score(y_train, model.predict(x_train))
print(training_acc)

test_acc = accuracy_score(y_test, model.predict(x_test))
print(test_acc)

